using System;
using System.Collections.Generic;
using System.Linq;
using System.Net.Mail;
using System.Web;

namespace VideoManager.Code
{
    public static class EmailHelper
    {
        const string server = "mail.midweststreams.com";
        const string password = "Midwetp1";
        const string email = "alert@midweststreams.com";

        public static void sendMessage(string to, string subject="Alert from Midwest Streams", string message="")
        {
            MailMessage mail = new MailMessage();

            SmtpClient smtpServer = new SmtpClient(server);

            smtpServer.Credentials = new System.Net.NetworkCredential(email, password);
            smtpServer.Port = 587; // Gmail works on this port

            mail.From = new MailAddress(email);
            mail.To.Add(to);
            mail.Subject = subject;
            mail.Body = message;

            smtpServer.Send(mail);
        }
        public static string GetOrderConfirmationEmailHTML(string firstName, string lastName, string downloadCode)
        {
            string html = "<div id=\":1eo\" class=\"a3s aXjCH m15b11b3f24790085\"><u></u><div marginwidth=\"0\" marginheight=\"0\" style=\"margin:0;padding:0;background-color:#f5f5f5;height:100%;width:100%\"><center>    <table align=\"center\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" height=\"100%\" width=\"100%\" id=\"m_-995248536077401421bodyTable\" style=\"margin:0;padding:0;background-color:#f5f5f5;border-collapse:collapse;height:100%;width:100%\">        <tbody><tr>            <td align=\"center\" valign=\"top\" id=\"m_-995248536077401421bodyCell\" style=\"margin:0;padding:20px;border-top:4px solid #7eabc0;height:100%;width:100%\">                                <table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" id=\"m_-995248536077401421templateHeader\" style=\"width:600px;background-color:#f5f5f5;border:1px solid #f5f5f5;border-collapse:collapse\">                    <tbody><tr>                        <td align=\"center\" valign=\"top\">                                                        <table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" id=\"m_-995248536077401421templatePreheader\" style=\"background-color:#f5f5f5;border-collapse:collapse\">                                <tbody><tr>                                    <td valign=\"top\" class=\"m_-995248536077401421preheaderContent\" style=\"text-align:left;line-height:125%;font-family:Helvetica;font-size:10px;color:#808080;padding-right:26px;padding-left:14px;padding-bottom:10px;padding-top:10px\">                                                                      </td>                                    <td valign=\"top\" width=\"180\" class=\"m_-995248536077401421preheaderContent\" style=\"text-align:left;line-height:125%;font-family:Helvetica;font-size:10px;color:#808080;padding-right:20px;padding-left:0;padding-bottom:10px;padding-top:10px\">                                                                </td>                                </tr>                            </tbody></table>                                                    </td>                    </tr>                </tbody></table>                <table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" id=\"m_-995248536077401421templateContainer\" style=\"width:600px;border:1px solid #eeeeee;border-collapse:collapse\">                    <tbody><tr>                        <td align=\"center\" valign=\"top\">                                                        <table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" id=\"m_-995248536077401421templateBody\" style=\"background-color:#ffffff;border-collapse:collapse\">                                <tbody><tr>                                    <td valign=\"top\" class=\"m_-995248536077401421bodyContent\" id=\"m_-995248536077401421body_content\" style=\"color:#333333;font-family:sans-serif;text-align:left;line-height:20px;padding-top:20px;padding-right:20px;padding-bottom:20px;padding-left:20px;font-size:14px\">                                        <p class=\"m_-995248536077401421center\" style=\"margin-left:auto;margin-right:auto;text-align:center;line-height:26px\">            </p><table width=\"50\" height=\"50\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" class=\"m_-995248536077401421status-icon m_-995248536077401421status-icon-success\" style=\"border-radius:50px;background-color:#5bb75b;font-family:sans-serif;font-weight:normal;margin:10px auto 20px auto;text-decoration:none;max-height:50px;text-align:center;height:50px;width:50px;border-collapse:collapse\">        <tbody><tr>            <td align=\"center\" valign=\"middle\" style=\"vertical-align:middle;text-align:center;width:100%;height:100%;padding:0\">                <span class=\"m_-995248536077401421mark\" style=\"color:#fff;font-size:30px;font-family:'Helvetica Neue',Helvetica,Arial,sans-serif;line-height:25px\">✓</span>            </td>        </tr>        </tbody></table><p></p><h1 style=\"line-height:40px;text-align:center;font-family:Helvetica;font-size:32px;font-style:normal;font-weight:normal;display:block;letter-spacing:normal;margin-top:0;margin-right:0;margin-bottom:18px;margin-left:0;color:#202020\">Order Complete.</h1><h2 style=\"line-height:18px;text-align:center;font-family:Helvetica;font-size:14px;font-style:normal;font-weight:normal;display:block;letter-spacing:normal;margin-top:0;margin-right:0;margin-bottom:25px;margin-left:0;color:#777\">Service: <strong>" + firstName + lastName+ "</strong></h2><hr style=\"border:0;border-top:1px solid #eee;height:0;margin-bottom:20px;margin-top:20px\"><p class=\"m_-995248536077401421center\" style=\"margin-left:auto;margin-right:auto;text-align:center;line-height:26px\">    Order Date: <strong>" + DateTime.Now.ToShortDateString() + "</strong></p><p class=\"m_-995248536077401421center\" style=\"margin-left:auto;margin-right:auto;text-align:center;line-height:26px\">        <a class=\"m_-995248536077401421btn m_-995248536077401421btn-primary\" href=\""+downloadCode+"\">Download Now</a>    </p><hr style=\"border:0;border-top:1px solid #eee;height:0;margin-bottom:20px;margin-top:20px\"><h3 style=\"letter-spacing:normal;display:block;font-size:16px;font-style:normal;font-weight:bold;line-height:20px;font-family:Helvetica;margin-top:0;margin-right:0;margin-bottom:10px;margin-left:0;text-align:left;color:#777\">Questions</h3><p>If you have any questions please contact support@midweststreams.com</p>                                    </td>                                </tr>                            </tbody></table>                                                    </td>                    </tr>                </tbody></table>                                <table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" id=\"m_-995248536077401421templateFooterSection\" style=\"width:600px;background-color:#f5f5f5;border:1px solid #f5f5f5;border-collapse:collapse\">                    <tbody><tr>                        <td align=\"center\" valign=\"top\">                                                            <table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" id=\"m_-995248536077401421templateFooter\" style=\"background-color:#f5f5f5;border-collapse:collapse\">                                <tbody><tr>                                    <td valign=\"top\" class=\"m_-995248536077401421footerContent\" style=\"color:#aaaaaa;font-family:Helvetica;text-align:center;line-height:15px;padding-top:20px;padding-right:20px;padding-bottom:20px;padding-left:20px;font-size:10px\">                                        <table class=\"m_-995248536077401421social-icons\" style=\"margin:10px auto;border-collapse:collapse\"><tbody><tr>                                                                         </tr></tbody></table><p style=\"margin-bottom:14px\"><br>408 Roberts St. Suite 203<br>Fargo, ND 58102</p>                                    </td>                                </tr>                            </tbody></table>                                                    </td>                    </tr>                </tbody></table>                                            </td>        </tr>    </tbody></table></center><div class=\"yj6qo\"></div><div class=\"adL\"></div></div><div class=\"adL\"></div></div>";
            return html;
        }
    }

   
}